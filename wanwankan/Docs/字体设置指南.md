# 字体设置指南

> 解决TextMeshPro中文显示问题（显示为方块□□）

---

## 🔍 问题诊断

如果看到中文显示为方块（□□），说明TextMeshPro组件没有使用支持中文的字体。

---

## ✅ 解决方案

### 方法1：使用TextMeshPro内置字体（临时方案）

TextMeshPro默认字体通常不支持中文，但至少不会报错。

**步骤：**
1. 打开 Unity 编辑器
2. 菜单：`WanWanKan → 字体修复 → 修复场景中所有字体`
3. 这会使用TextMeshPro默认字体（英文可以显示，中文可能显示为方块）

---

### 方法2：导入中文字体（推荐方案）

#### 步骤1：准备字体文件

需要准备支持中文的字体文件（.ttf或.otf格式），例如：
- 思源黑体（Source Han Sans）
- 微软雅黑
- 其他支持中文的字体

#### 步骤2：创建字体资源

1. **创建Resources目录**（如果不存在）
   - 在 `Assets` 下创建 `Resources` 文件夹
   - 在 `Resources` 下创建 `Font` 文件夹

2. **导入字体文件**
   - 将字体文件（.ttf）放入 `Assets/Resources/Font/` 目录

3. **创建TextMeshPro字体资源**
   - 选中字体文件
   - 菜单：`Window → TextMeshPro → Font Asset Creator`
   - 在Font Asset Creator窗口中：
     - **Source Font File**: 选择你的字体文件
     - **Sampling Point Size**: 建议72或更高
     - **Padding**: 建议5
     - **Packing Method**: Fast
     - **Character Set**: 
       - 选择 "Characters from File"（如果字体文件包含字符集）
       - 或选择 "Unicode Range" 并输入中文范围：`0x4E00-0x9FFF`（常用汉字）
     - 点击 **Generate Font Atlas**
     - 点击 **Save** 或 **Save as...**
     - 保存为：`Assets/Resources/Font/SourceHanSansSC-Normal SDF.asset`

#### 步骤3：验证字体

1. 运行字体修复工具：
   - 菜单：`WanWanKan → 字体修复 → 打开字体修复窗口`
   - 查看"当前中文字体"是否显示字体名称

2. 如果显示字体名称，说明字体已正确设置

---

### 方法3：使用现有字体资源

如果你已经有TextMeshPro字体资源：

1. **找到字体资源文件**（.asset文件）
2. **移动到正确位置**：
   - 复制到 `Assets/Resources/Font/` 目录
   - 重命名为 `SourceHanSansSC-Normal SDF.asset`
3. **或者修改字体路径**：
   - 编辑 `Assets/Scripts/UI/FontFixer.cs`
   - 修改 `CHINESE_FONT_PATH` 常量为你字体资源的路径

---

## 🛠️ 快速修复工具

### 编辑器工具

**菜单：`WanWanKan → 字体修复`**

- **修复场景中所有字体** - 修复当前场景
- **修复选中对象的所有字体** - 修复选中的GameObject
- **修复所有预制体中的字体** - 批量修复预制体（需谨慎）
- **打开字体修复窗口** - 查看字体状态和工具

### 运行时自动修复

游戏运行时会自动尝试修复所有TextMeshPro组件的字体。

---

## 📝 字体资源要求

### 文件位置
```
Assets/
└── Resources/
    └── Font/
        └── SourceHanSansSC-Normal SDF.asset
```

### 字体资源属性
- **类型**: TMP_FontAsset
- **字符集**: 必须包含中文字符（Unicode范围 0x4E00-0x9FFF）
- **格式**: SDF（Signed Distance Field）

---

## 🔧 手动设置字体（如果工具不工作）

如果自动修复工具不工作，可以手动设置：

1. **选中场景中的TextMeshPro组件**
2. **在Inspector中找到Font Asset字段**
3. **拖拽中文字体资源到Font Asset字段**

或者：

1. **选中所有需要修复的TextMeshPro组件**（可以多选）
2. **在Inspector中设置Font Asset**
3. **点击Apply应用到所有选中对象**

---

## ⚠️ 常见问题

### Q: 修复后中文还是显示为方块

**A:** 可能原因：
1. 字体资源不存在或路径不对
2. 字体资源没有包含中文字符集
3. 需要重新生成字体资源并包含中文Unicode范围

**解决方法：**
1. 检查字体资源是否存在
2. 使用Font Asset Creator重新生成字体，确保包含中文字符
3. 检查Console是否有错误信息

---

### Q: 修复工具报错

**A:** 如果看到 "Failed to find LegacyRuntime Font SDF.asset" 错误：
- 这是正常的，说明找不到中文字体
- 工具会自动使用TextMeshPro默认字体（不会报错）
- 但默认字体不支持中文，需要导入中文字体资源

---

### Q: 如何检查字体是否支持中文

**A:** 
1. 打开字体资源（.asset文件）
2. 在Inspector中查看 "Character Table"
3. 搜索中文字符（如"地"、"图"）
4. 如果找到，说明支持中文

---

## 📚 参考资源

- [TextMeshPro官方文档](https://docs.unity3d.com/Packages/com.unity.textmeshpro@3.0/manual/index.html)
- [TextMeshPro字体创建教程](https://docs.unity3d.com/Packages/com.unity.textmeshpro@3.0/manual/FontAssetCreator.html)

---

*文档版本：1.0*  
*最后更新：2024-12-18*
